# 文档智能比对分析工具 - 使用说明

## 功能概述

文档智能比对分析工具是一款基于 AI 技术的在线文档比对工具，可以帮助您：

- 📄 快速比对两篇 Word 文档的差异
- 🎨 直观地高亮显示新增和删除的内容
- 🔍 一键跳转到任意差异点
- 🔄 双文档同步滚动查看
- 🤖 使用 AI 智能分析每个差异点和整体变更
- 📊 生成专业的详细分析报告

## 使用步骤

### 1. 上传文档

在页面顶部，您会看到两个上传区域：

- **左侧**：上传文档 1（原始版本）
- **右侧**：上传文档 2（修改版本）

支持两种上传方式：
- 点击上传区域，选择文件
- 直接拖拽 .doc 或 .docx 文件到上传区域

上传成功后，会显示文件名和文件大小。

### 2. 开始比对

当两篇文档都上传完成后，点击中间的 **"开始比对分析"** 按钮。

系统会自动：
1. 解析两篇文档的内容
2. 进行词级别的差异比对
3. 生成差异高亮显示
4. 调用 AI 进行智能分析

### 3. 查看结果

比对完成后，页面会显示四栏内容：

#### 左栏 - 差异导航
- 显示所有差异点的列表
- 每个差异点显示序号、类型（新增/删除）和内容预览
- 顶部显示新增和删除的总数统计
- **点击任意差异点**，可以快速跳转到对应位置
- 当前选中的差异点会高亮显示

#### 第二栏 - 文档 1（原始版本）
- 显示原始文档内容
- 红色背景 + 删除线标记被删除的内容
- 点击差异导航时，自动滚动到对应位置
- 当前查看的差异点会有蓝色边框高亮

#### 第三栏 - 文档 2（修改版本）
- 显示修改后的文档内容
- 黄色背景标记新增的内容
- 与文档 1 同步滚动和跳转
- 当前查看的差异点会有蓝色边框高亮

#### 右栏 - AI 智能分析
实时显示 AI 生成的详细分析报告，包括：

- **📊 差异概览**：总结主要变更和趋势
- **🔍 逐项差异分析**：
  - **新增内容分析**：针对每个重要新增点的详细分析
    - 内容摘要
    - 变更类型
    - 重要程度（星级评分）
    - 影响分析
    - 具体建议
  - **删除内容分析**：针对每个重要删除点的详细分析
    - 内容摘要
    - 变更类型
    - 重要程度（星级评分）
    - 影响分析
    - 具体建议
- **📈 整体变更分析**：
  - 变更主题
  - 变更程度
  - 变更影响
  - 风险提示
- **💡 总体评价与建议**：
  - 变更合理性评价
  - 改进建议
  - 注意事项

## 核心功能详解

### 🔍 差异导航与一键跳转

**功能说明**：
- 左侧差异导航面板列出所有有意义的差异点
- 每个差异点都有唯一编号和类型标识
- 点击任意差异点，两个文档查看器会自动滚动到对应位置
- 当前查看的差异点会有明显的视觉反馈

**使用技巧**：
1. 快速浏览差异列表，了解整体变更情况
2. 点击感兴趣的差异点，查看详细内容
3. 结合 AI 分析，理解每个变更的意义

### 🔄 同步滚动

**功能说明**：
- 两个文档查看器支持同步滚动
- 点击差异导航时，两个文档会同时跳转到对应位置
- 方便对照查看同一位置的变更

### 🤖 AI 详细分析

**功能说明**：
- AI 会分析每个重要的差异点
- 提供星级重要程度评分（⭐⭐⭐⭐⭐）
- 分析每个变更的影响和建议
- 提供整体变更的综合评价

**分析维度**：
1. **单点分析**：每个差异点的独立分析
2. **整体分析**：所有变更的综合影响评估
3. **风险提示**：需要特别关注的风险点
4. **改进建议**：进一步优化的方向

## 颜色说明

- 🟡 **黄色背景**：新增的内容
- 🔴 **红色背景 + 删除线**：删除的内容
- 🔵 **蓝色边框**：当前选中查看的差异点
- ⚪ **无背景色**：未变更的内容

## 使用技巧

1. **文档格式**：确保上传的是 .doc 或 .docx 格式的 Word 文档
2. **文档大小**：建议单个文档不超过 10MB，以获得最佳性能
3. **内容长度**：对于特别长的文档，AI 会分析前 20 个重要差异点
4. **快速定位**：使用差异导航快速定位到感兴趣的变更点
5. **对照查看**：利用同步滚动功能，对照查看两个版本的差异
6. **详细分析**：结合 AI 的逐项分析和整体分析，全面理解文档变更

## 常见问题

### Q: 支持哪些文档格式？
A: 目前支持 .doc 和 .docx 格式的 Microsoft Word 文档。

### Q: AI 分析需要多长时间？
A: 通常在 20-60 秒内完成，具体时间取决于文档长度和差异数量。AI 分析采用流式输出，您可以实时看到分析结果。

### Q: 如何快速找到某个差异点？
A: 使用左侧的差异导航面板，点击任意差异点即可快速跳转到对应位置，两个文档会同步滚动。

### Q: AI 会分析所有差异点吗？
A: AI 会重点分析前 20 个有意义的差异点（过滤掉空白和无意义的变更），并提供整体变更的综合分析。

### Q: 文档内容会被保存吗？
A: 不会。所有文档处理都在浏览器端完成，AI 分析仅发送差异摘要，不会保存您的文档内容。

### Q: 可以比对多少次？
A: 没有次数限制，您可以随时上传新的文档进行比对。

### Q: 如果文档比对失败怎么办？
A: 请确保：
- 上传的是有效的 Word 文档
- 文档没有损坏
- 文档不是受密码保护的
- 浏览器支持现代 Web 标准

### Q: 差异点的重要程度是如何评定的？
A: AI 会根据差异内容的性质、长度、位置等因素，综合评估重要程度，用 1-5 星表示。

## 技术支持

如果您在使用过程中遇到任何问题，请查看：
- 浏览器控制台的错误信息
- 确保使用最新版本的现代浏览器（Chrome、Firefox、Edge、Safari）
- 检查网络连接是否正常

## 隐私说明

- 文档解析在本地浏览器完成
- 仅将文档差异摘要发送给 AI 进行分析
- 不会存储或传输完整文档内容
- 所有数据传输使用 HTTPS 加密

## 最佳实践

### 合同文档比对
1. 上传原始合同和修订版本
2. 使用差异导航快速浏览所有变更
3. 重点关注 AI 标注为高重要度（⭐⭐⭐⭐⭐）的变更
4. 查看整体变更分析中的风险提示

### 报告修订审查
1. 上传初稿和修订稿
2. 逐个查看差异点，理解每处修改的意图
3. 参考 AI 的改进建议，进一步优化文档
4. 关注整体变更分析中的变更主题

### 政策文件变更分析
1. 上传旧版本和新版本政策文件
2. 使用差异导航快速定位关键变更
3. 重点分析 AI 提示的高风险变更
4. 查看整体影响分析，评估政策调整的影响范围
